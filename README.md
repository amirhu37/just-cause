
<div dir="rtl">

# **راهنمای جامع تحلیل علیت با گرنجر و MLP**


## **۱. مقدمه‌ای بر تحلیل علیت در سری‌های زمانی**

یافتن رابطهٔ علّی بین دو متغیر سری زمانی (مثل قیمت طلا و دلار) کار ساده‌ای نیست، چون معمولاً این داده‌ها فقط *همبستگی* را نشان می‌دهند. برای اینکه بفهمیم «آیا تغییرات یک متغیر *باعث* تغییر در دیگری می‌شود یا نه؟»، از روش‌هایی مانند:

* **تست علیت گرنجر (Granger Causality)**
* **مدل‌های غیرخطی مثل MLP برای پیش‌بینی جهت‌دار**

استفاده می‌کنیم.

این روش‌ها علیت فلسفی یا حقیقی را تضمین نمی‌کنند، اما به ما می‌گویند:

> آیا اطلاعات گذشتهٔ متغیر A در پیش‌بینی آیندهٔ B کمک می‌کند؟

اگر بله → به آن «علیت گرنجری» می‌گوییم.

---

## **۲. تعریف تست گرنجر (Granger Causality Test)**

تست گرنجر بررسی می‌کند:

> آیا افزودن داده‌های گذشتهٔ **متغیر X** باعث بهبود پیش‌بینی **متغیر Y** می‌شود یا خیر؟

اگر بله باشد، می‌گوییم:

```
X → Y  (X گرنجری باعث Y می‌شود)
```

### ایدهٔ اصلی

* اگر گذشتهٔ Y را داشته باشیم → یک مدل پایه درست می‌کنیم.
* سپس گذشتهٔ X را اضافه می‌کنیم → مدل کامل.
* اگر مدل کامل **پیش‌بینی بهتری** از مدل پایه بدهد → X، علت گرنجری Y است.

### خروجی‌های مهم:

* **p-value**: اگر p < 0.05 باشد → علیت معتبر است.
* **lag**: تعداد گام‌های زمانی که اثرات X بر Y اندازه‌گیری شده.

---

## **۳. تعریف سادهٔ MLP (شبکهٔ عصبی چندلایه)**

ا **MLP** (Multi-Layer Perceptron) یک شبکهٔ عصبی ساده است با چند لایه:

* لایهٔ ورودی
* یک یا چند لایهٔ مخفی با توابع فعال‌ساز
* لایهٔ خروجی

### چرا MLP؟

چون گرنجر *فقط روابط خطی* را بررسی می‌کند.

اما در اکثر داده‌های بازار، رابطه‌های غیرخطی مثل:

* اثرات آستانه‌ای
* رابطه‌های چندجمله‌ای
* تعاملات پیچیده

وجود دارند.

پس برای بررسی علیت غیرخطی، یک مدل MLP را:

* یک بار فقط با داده‌های گذشتهٔ Y (مدل پایه)
* یک بار با اضافه کردن گذشتهٔ X (مدل کامل)

آموزش می‌دهیم.

### تفسیر در MLP:

* اگر **MSE مدل کامل کمتر از مدل پایه باشد** → X در پیش‌بینی Y کمک کرده → علیت غیرخطی.

اگر نه → علیت غیرخطی وجود ندارد.

---

## **۴. چرا از این روش‌ها استفاده می‌کنیم؟**

### دلیل ۱ — فهم روابط جهت‌دار

معمولاً همبستگی‌ها **متقارن** هستند، اما علیت **جهت‌دار** است.
گرنجر اولین گام برای فهم این جهت‌گیری است.

### دلیل ۲ — جدا کردن روابط خطی و غیرخطی

* گرنجر → روابط خطی
* MLP → روابط پیچیده‌تر و غیرخطی

ترکیب این دو به ما می‌گوید:

* آیا رابطهٔ خطی وجود دارد؟
* آیا رابطهٔ غیرخطی وجود دارد؟
* آیا رابطه دوطرفه است یا یکطرفه؟

### دلیل ۳ — استفاده در تحلیل بازار

برای سرمایه‌گذاری، مهم است بدانیم:

* کدام دارایی «پیش‌نگر» است؟
* کدام متغیر «دنباله‌رو» است؟

مثلاً:

* آیا تغییرات طلا روی دلار اثر می‌گذارد؟
* یا برعکس؟

---

## **۵. نحوهٔ نتیجه‌گیری از نتایج**

### مرحلهٔ ۱ — بررسی ایستایی

اگر سری‌ها ایستا نباشند، نتایج غلط می‌شوند.
پس اول با تست ADF چک می‌کنیم.

### مرحلهٔ ۲ — بررسی گرنجر (علیت خطی)

اگر:

```
p < 0.05
```

→ رابطهٔ خطی وجود دارد.

### مرحلهٔ ۳ — بررسی MLP (علیت غیرخطی)

* اگر MSE مدل کامل **کمتر** از پایه → رابطهٔ غیرخطی وجود دارد.

### مرحلهٔ ۴ — تصمیم کلی

سه حالت ممکن است:

#### **۱. خطی وجود دارد، غیرخطی وجود ندارد**

رابطهٔ علیت ساده و خطی است.

#### **۲. خطی وجود ندارد، غیرخطی وجود دارد**

رابطهٔ پیچیده است.

#### **۳. هر دو وجود دارد**

اثر قوی و چندشکلی است.

#### **۴. هیچ‌کدام وجود ندارد**

هیچ علیتی یافت نشد.

---

## **۶. مثال تفسیر خروجی ما**

خلاصهٔ نتایج:

* علیت خطی:

  **gold return → usd return** مثبت و معنادار

  **usd return → gold return** غیرمعنادار

* علیت غیرخطی:
  در هیچ‌کدام وجود ندارد.

### تفسیر تغییرات بازده:


> تغییرات بازدهٔ طلا باعث تغییرات بازدهٔ دلار می‌شود، اما دلار علت تغییرات طلا نیست.

</div>